/// 本クラスについて<br/>
/// Use or operation of this code is subject to acceptance of the license available in the code repository for this code.
/// This sample persistent class represents a person.
Class Sample.Person Extends (%Persistent, %Populate, %XML.Adaptor)
{

/// ccc
Parameter EXTENTQUERYSPEC = "Name,SSN,Home.City,Home.State";

/// Define a unique index for <property>SSN</property>.
Index SSNKey On SSN [ Type = index, Unique ];

/// Define an index for <property>Name</property>.
Index NameIDX On Name [ Data = Name ];

/// Define an index for embedded object property <b>ZipCode</b>.
Index ZipCode On Home.Zip [ Type = bitmap ];

/// Person's name.
Property Name As %String(POPSPEC = "Name()") [ Required ];

/// Person's Social Security number. This is validated using pattern match.
Property SSN As %String(PATTERN = "3N1""-""2N1""-""4N") [ Required ];

/// Person's Date of Birth.
Property DOB As %Date(POPSPEC = "Date()");

/// Person's home address. This uses an embedded object.
Property Home As Address;

/// Person's office address. This uses an embedded object.
Property Office As Address;

/// Person's spouse. This is a reference to another persistent object.
Property Spouse As Person;

/// A collection of strings representing the person's favorite colors.
Property FavoriteColors As list Of %String(JAVATYPE = "java.util.List", POPSPEC = "ValueList("",Red,Orange,Yellow,Green,Blue,Purple,Black,White""):2");

/// Person's age.<br>
/// This is a calculated field whose value is derived from <property>DOB</property>.
Property Age As %Integer [ Calculated, SqlComputeCode = { Set {Age}=##class(Sample.Person).CurrentAge({DOB})
}, SqlComputed, SqlComputeOnChange = DOB ];

/// This class method calculates a current age given a date of birth <var>date</var>.
/// This method is used by the Age calculated field.
ClassMethod CurrentAge(date As %Date = "") As %Integer [ CodeMode = expression ]
{
$Select(date="":"",1:($ZD($H,8)-$ZD(date,8)\10000))
}

/// A sample class query that defines a result set that returns Person data 
/// ordered by <property>Name</property>.<br>
/// This query can be used within another method (using 
/// dynamic SQL), or it can be used from Java.<br>
/// This query is also accessible from JDBC and/or ODBC as the SQL stored procedure 
/// <b>SP_Sample_By_Name</b>.
Query ByName(name As %String = "") As %SQLQuery(CONTAINID = 1, SELECTMODE = "RUNTIME") [ SqlName = SP_Sample_By_Name, SqlProc ]
{
SELECT ID, Name, DOB, SSN
FROM Sample.Person
WHERE (Name %STARTSWITH :name)
ORDER BY Name
}

Storage Default
{
<Data name="PersonDefaultData">
<Value name="1">
<Value>%%CLASSNAME</Value>
</Value>
<Value name="2">
<Value>Name</Value>
</Value>
<Value name="3">
<Value>SSN</Value>
</Value>
<Value name="4">
<Value>DOB</Value>
</Value>
<Value name="5">
<Value>Home</Value>
</Value>
<Value name="6">
<Value>Office</Value>
</Value>
<Value name="7">
<Value>Spouse</Value>
</Value>
<Value name="8">
<Value>FavoriteColors</Value>
</Value>
</Data>
<DataLocation>^Sample.PersonD</DataLocation>
<DefaultData>PersonDefaultData</DefaultData>
<ExtentSize>201</ExtentSize>
<IdLocation>^Sample.PersonD</IdLocation>
<IndexLocation>^Sample.PersonI</IndexLocation>
<Property name="%%CLASSNAME">
<AverageFieldSize>10.54</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,0,8,$lb("-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","~Sample.Employee~","~Sample.Employee~","~Sample.Employee~","~Sample.Employee~","~Sample.Employee~","~Sample.Employee~","~Sample.Employee~","~Sample.Employee~"),$lb(21,21,21,21,21,21,21,0,18,18,18,18,18,18,18),$lb(758198320,0,0,0,0,0,0,0,0,0,0,0,0,0,0,758198320,2119393645,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2119393645))</Histogram>
<Selectivity>50.0000%</Selectivity>
</Property>
<Property name="%%ID">
<AverageFieldSize>3</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,1,0,$lb(1,14,28,42,56,70,83,96,109,122,135,148,161,174,187,200),$lb(1,0,0,0,0,0,0,0,1,1,1,1,1,1,0),$lb(822083584,0,872415232,825491456,842530816,842530816,875692032,875692032,892731392,892731392,925892608,925892608,942866432,942866432,959840256,959840256,825243904,809041920,842137600,842137600,859111424,859111424,876085248,876085248,909180928,909180928,926154752,926154752,943128576,825767680,842018816,842018816))</Histogram>
<Selectivity>1</Selectivity>
</Property>
<Property name="Age">
<AverageFieldSize>2.99</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,1,0,$lb(0,5,17,22,28,38,41,52,57,63,70,77,83,88,92,98),$lb(0,0,0,1,0,0,0,1,0,0,1,0,1,0,1),$lb(805306368,805306368,889192448,889192448,825688064,825688064,842137600,838860800,939524096,842530816,859308032,859308032,875626496,875626496,892469248,838860800,922746880,892796928,909312000,909312000,925892608,805306368,922746880,926351360,942866432,855638016,939524096,943194112,959578112,838860800,939524096,959971328))</Histogram>
<Selectivity>1.1628%</Selectivity>
</Property>
<Property name="DOB">
<AverageFieldSize>4.02</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,0,0,$lb(30299,32437,33918,35821,38051,41168,43229,45451,48290,51308,52816,56328,58185,59821,63959,66112),$lb(1,1,1,1,0,1,1,1,0,1,1,1,1,0,1),$lb(858796601,808597817,842281783,842281783,859386168,859386168,892875313,892875313,942683441,859320373,875639094,825308728,858927673,858927673,892613937,892613937,942815536,876098105,892416816,825438264,842543414,842543414,909324856,909324856,942749749,942749749,959984177,892942386,909326645,859387193,909193522,909521201))</Histogram>
<Selectivity>0.5000%</Selectivity>
</Property>
<Property name="FavoriteColors">
<AverageFieldSize>9.63</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,0,5,$lb("-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000",$lb("Red","Black"),$lb("Blue"),$lb("Black"),$lb("Green"),$lb("Green","Purple"),$lb("White","Blue"),$lb("Orange"),$lb("Orange","Orange"),$lb("Purple","Red"),$lb("Yellow"),$lb("Yellow","Purple")),$lb(21,21,21,21,0,5,7,5,11,5,5,12,5,5,12),$lb(758198320,0,0,0,0,0,0,0,0,758198320,83972709,117523052,1694498816,0,0,1667956736,1701707776,0,1919970405,1701709825,1952777729,1952777729,1852269824,0,1634625381,1852269832,1886151941,1886151941,1819244288,0,1919970405,134306149))</Histogram>
<OutlierSelectivity>.288557:</OutlierSelectivity>
<Selectivity>1.4519%</Selectivity>
</Property>
<Property name="Home">
<AverageFieldSize>37.94,City:9.08,State:4,Street:18.42,Zip:4.44</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,0,0,$lb($lb("102 Elm Place","Miami","ND",39125),$lb("858 Elm Drive","Fargo","SD",52428),$lb("3349 Ash Court","St Louis","TX",38695),$lb("8506 Elm Drive","Chicago","HI",77164),$lb("282 Maple Drive","Chicago","MT",16201),$lb("5579 Ash Street","Washington","IL",21617),$lb("1203 Second Blvd","Boston","MD",53217),$lb("7108 First Place","Xavier","IA",48811),$lb("9771 Maple Court","Larchmont","UT",33565),$lb("9272 Maple Avenue","Denver","ID",43850),$lb("3659 Clinton Drive","Boston","VT",45573),$lb("5914 Franklin Blvd","Oak Creek","CA",42893),$lb("9969 Clinton Drive","Gansevoort","SC",89535),$lb("4622 Franklin Court","Elmhurst","WA",50696),$lb("230 Washington Place","Miami","WY",10864),$lb("9545 Washington Court","Queensbury","PA",11226)),$lb(5,5,5,5,5,5,5,5,6,5,5,5,5,5,5),$lb(251736368,541420653,541420653,541420653,958415219,958415219,908084588,908084588,541942128,541942128,958415219,958415219,857756517,857756517,941639273,941639273,824200545,541942128,541942128,840977761,958415724,958415724,874530418,874530418,958415724,958415724,840975986,840975986,542597491,542597491,891311969,385956149)),City:$lb(.06666666666666666667,0,0,$lb(" ALBANY"," BENSONHURST"," CHICAGO"," ELMHURST"," FARGO"," HIALEAH"," ISLIP"," LARCHMONT"," MIAMI"," NEWTON"," QUEENSBURY"," ST LOUIS"," TAMPA"," VAIL"," YOUNGSTOWN"," ZANESVILLE"),$lb(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),$lb(541150274,1095516737,1111838291,1111838291,1128810819,1128810819,1162628424,1162628424,1178686023,1178686023,1212760396,1212760396,1230195785,1230195785,1279349315,1279349315,1296646477,1296646477,1313167188,1313167188,1364542789,1364542789,1398022220,1398022220,1413565776,1413565776,1447119180,1447119180,1498371406,1498371406,1514229317,542785870)),State:$lb(.06666666666666666667,0,0,$lb(" AK"," AL"," CO"," GA"," ID"," MA"," MI"," MS"," ND"," NJ"," OH"," RI"," SD"," VA"," WA"," WY"),$lb(2,1,1,1,1,2,2,1,2,1,1,1,1,1,2),$lb(541149952,1258291200,1275068416,1095499776,1129250816,1129250816,1195442176,1195442176,1229193216,1229193216,1296105472,1090519040,1224736768,1224736768,1392508928,1297285120,1313079296,1140850688,1241513984,1313472512,1330118656,1330118656,1380515840,1380515840,1396965376,1396965376,1447100416,1447100416,1463877632,1090519040,1493172224,542595328)),Street:$lb(.06666666666666666667,0,0,$lb(" 1003 WASHINGTON BLVD"," 1620 OAK BLVD"," 2043 MADISON STREET"," 2635 FRANKLIN PLACE"," 3154 FRANKLIN DRIVE"," 3497 FIRST COURT"," 4313 FRANKLIN BLVD"," 5082 CLINTON STREET"," 5752 FIRST PLACE"," 6258 FRANKLIN AVENUE"," 7219 FRANKLIN STREET"," 7787 ASH STREET"," 8277 MAIN AVENUE"," 8902 ELM COURT"," 9405 MAIN BLVD"," 9937 FIRST AVENUE"),$lb(2,1,2,1,2,1,1,2,1,1,2,1,2,1,2),$lb(540094512,808465184,909258784,825635376,842019891,808727328,909325600,842412853,858862900,825570336,876164896,859060535,875770163,875770163,892352562,808989216,926233120,892810546,909260088,909260088,926036281,842086688,926431008,926365751,942815031,842479392,959459872,943271986,959721525,875574560,959657760,540621107)),Zip:$lb(.06666666666666666667,0,0,$lb(" 10589"," 15312"," 21646"," 28486"," 35012"," 43225"," 50016"," 55824"," 63921"," 68954"," 71767"," 75318"," 81537"," 87699"," 93542"," 96817"),$lb(2,1,2,1,1,1,2,1,2,1,2,1,2,1,2),$lb(540094517,808794169,892547378,825570097,842085940,825635894,942946358,842544184,859123761,859123761,875770418,875770418,892350513,808464694,892875316,892680242,909326642,859386417,943273268,909654325,925972278,825701943,892547384,926233393,942748979,825570103,926300473,943142457,959657268,859124786,909652279,540620344))</Histogram>
<Selectivity>0.5000%,City:3.8462%,State:2.0408%,Street:0.5000%,Zip:0.5000%</Selectivity>
</Property>
<Property name="Name">
<AverageFieldSize>18.1</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,0,0,$lb(" ALTON,FRED I."," CHENG,JOCELYN S."," DUNLAP,ALVIN T."," GARCIA,EDGAR N."," HERNANDEZ,GERTRUDE F."," JAYNES,JULIE U."," LOVE,ALICE O."," NOODLEMAN,MARVIN E."," OTT,NELLIE C."," RAGON,VINCENT F."," TAYLOR,ZELDA H."," UMANSKY,NATASHA C."," VIVALDI,JOSE O."," XAVIER,CHAD F."," YEZEK,AMANDA W."," ZUBIK,HELOISA F."),$lb(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),$lb(541150292,1095521359,1128809806,1128809806,1146441292,1146441292,1195463235,1195463235,1212502606,1212502606,1245796686,1245796686,1280267845,1280267845,1313820484,1313820484,1330926636,1330926636,1380009807,1380009807,1413568844,1413568844,1431126350,1431126350,1447646785,1447646785,1480676937,1480676937,1497717317,1497717317,1515536969,542790978))</Histogram>
<Selectivity>0.5000%</Selectivity>
</Property>
<Property name="Office">
<AverageFieldSize>38.25,City:9.22,State:4,Street:18.66,Zip:4.37</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,0,0,$lb($lb("210 Elm Drive","Larchmont","HI",46509),$lb("2717 Oak Place","Gansevoort","NV",92234),$lb("8544 Ash Place","Bensonhurst","MT",39022),$lb("2403 Maple Blvd","St Louis","MT",27096),$lb("7391 Oak Street","Hialeah","ND",67186),$lb("1163 First Court","Larchmont","HI",52752),$lb("2578 Main Street","St Louis","RI",35258),$lb("7009 Second Blvd","St Louis","AR",59225),$lb("3409 Second Place","Washington","CO",14827),$lb("7174 First Avenue","Jackson","NC",93828),$lb("1807 Clinton Place","Xavier","IA",48534),$lb("6313 Second Avenue","Youngstown","NJ",27365),$lb("956 Franklin Court","Newton","MA",51363),$lb("7573 Clinton Avenue","Youngstown","NC",98961),$lb("8608 Franklin Avenue","Chicago","AR",87808),$lb("7698 Washington Avenue","Albany","VT",74704)),$lb(6,5,5,5,5,5,5,5,5,5,5,5,5,5,5),$lb(251736625,1164733728,542073195,924864353,874529139,874529139,857754977,857754977,824201057,824201057,857753193,857753193,941641057,941641057,958419813,958419813,958419813,958419813,874530409,874530409,924861292,924861292,857756517,857756517,541487713,541487713,857752428,857752428,941639282,941639282,941643617,402732854)),City:$lb(.06666666666666666667,0,0,$lb(" ALBANY"," BENSONHURST"," CHICAGO"," ELMHURST"," HIALEAH"," ISLIP"," LARCHMONT"," NEWTON"," PUEBLO"," QUEENSBURY"," RESTON"," TAMPA"," UKIAH"," WASHINGTON"," XAVIER"," ZANESVILLE"),$lb(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),$lb(541150274,1095516737,1111838291,1111838291,1128810819,1128810819,1162628424,1162628424,1212760396,1212760396,1230195785,1230195785,1279349315,1279349315,1313167188,1313167188,1347765570,1347765570,1364542789,1364542789,1380275028,1380275028,1413565776,1413565776,1430997313,1430997313,1463898952,1463898952,1480676937,1480676937,1514229317,542785870)),State:$lb(.06666666666666666667,0,0,$lb(" AK"," CA"," DE"," IA"," KS"," MA"," MI"," MS"," ND"," NJ"," NY"," OK"," RI"," TN"," VT"," WV"),$lb(1,1,1,1,1,2,2,1,2,2,1,1,1,1,1),$lb(541149952,1095434240,1128333312,1128333312,1145372672,1145372672,1228996608,1228996608,1263730688,1263730688,1296105472,1090519040,1224736768,1224736768,1392508928,1297285120,1313079296,1140850688,1241513984,1241513984,1493172224,1314455552,1330315264,1330315264,1380515840,1380515840,1414397952,1414397952,1448345600,1448345600,1465253888,542594560)),Street:$lb(.06666666666666666667,0,0,$lb(" 1013 MAIN AVENUE"," 1688 ASH DRIVE"," 2117 CLINTON BLVD"," 2610 FRANKLIN COURT"," 3143 ELM STREET"," 4023 SECOND STREET"," 5023 SECOND COURT"," 598 MADISON COURT"," 6503 CLINTON PLACE"," 7174 FIRST AVENUE"," 7566 WASHINGTON AVENUE"," 8088 MAPLE AVENUE"," 8642 FRANKLIN DRIVE"," 9076 ELM AVENUE"," 9492 MADISON DRIVE"," 9877 FRANKLIN AVENUE"),$lb(2,1,2,1,1,1,2,1,1,2,1,2,1,2,2),$lb(540094513,808530720,909654048,825636920,842084663,825308960,909193248,842412336,858862643,858862643,875573811,875573811,892351027,808596256,959979597,892942368,909455411,909455411,925972276,825701408,892745248,926234166,942684216,808990752,909390368,943076402,959461174,808924704,876163616,876163616,943142688,540620855)),Zip:$lb(.06666666666666666667,0,0,$lb(" 10315"," 15160"," 23941"," 30292"," 36254"," 41874"," 48886"," 53219"," 58916"," 62515"," 67871"," 74610"," 80702"," 86844"," 91493"," 98961"),$lb(2,1,1,2,1,2,1,2,1,2,1,1,2,1,2),$lb(540094515,808661301,892417584,825569590,842217780,842217780,858796601,808597810,909260084,859189813,875640887,825767732,943208502,876099640,892547633,858927417,943272246,892877105,909260081,842346805,926431025,909588535,926168625,926168625,942683952,808923186,909653044,943077428,959525945,825506099,943273521,540620857))</Histogram>
<Selectivity>0.5000%,City:3.8462%,State:2.0408%,Street:0.5000%,Zip:0.5025%</Selectivity>
</Property>
<Property name="SSN">
<AverageFieldSize>13</AverageFieldSize>
<Selectivity>1</Selectivity>
</Property>
<Property name="Spouse">
<AverageFieldSize>2.95</AverageFieldSize>
<Histogram>$lb(.06666666666666666667,1,8,$lb("-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","-10000000000000000000","7","27","39","51","67","75","90","98"),$lb(21,21,21,21,21,21,21,0,0,0,0,0,0,0,1),$lb(758198320,0,0,0,0,0,0,0,0,0,0,0,0,0,0,758198320,922746880,922746880,842465280,842465280,859373568,859373568,892403712,892403712,909574144,909574144,926220288,926220288,959447040,805306368,939524096,959971328))</Histogram>
<OutlierSelectivity>.497512:</OutlierSelectivity>
<Selectivity>0.7390%</Selectivity>
</Property>
<SQLMap name="$Person">
<BlockCount>-4</BlockCount>
</SQLMap>
<SQLMap name="IDKEY">
<BlockCount>-20</BlockCount>
</SQLMap>
<SQLMap name="NameIDX">
<BlockCount>-8</BlockCount>
</SQLMap>
<SQLMap name="SSNKey">
<BlockCount>-8</BlockCount>
</SQLMap>
<SQLMap name="ZipCode">
<BlockCount>-8</BlockCount>
</SQLMap>
<StreamLocation>^Sample.PersonS</StreamLocation>
<Type>%Storage.Persistent</Type>
}

}
